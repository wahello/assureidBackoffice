{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/mongo","imported":["Mongo"],"specifiers":[{"kind":"named","imported":"Mongo","local":"Mongo"}]},{"source":"react","imported":["default","Component"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"Component","local":"Component"}]},{"source":"react-dom","imported":["render"],"specifiers":[{"kind":"named","imported":"render","local":"render"}]},{"source":"meteor/ultimatejs:tracker-react","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"TrackerReact"}]},{"source":"meteor/react-meteor-data","imported":["createContainer"],"specifiers":[{"kind":"named","imported":"createContainer","local":"createContainer"}]},{"source":"react-validation","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"Validation"}]},{"source":"validator","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"validator"}]},{"source":"meteor/tracker","imported":["Tracker"],"specifiers":[{"kind":"named","imported":"Tracker","local":"Tracker"}]},{"source":"../api/Blocks","imported":["Blocks"],"specifiers":[{"kind":"named","imported":"Blocks","local":"Blocks"}]},{"source":"../api/Blocks","imported":["TempBlockImages"],"specifiers":[{"kind":"named","imported":"TempBlockImages","local":"TempBlockImages"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/dashboard/reactCMS/components/BlocksPage.jsx","filenameRelative":"imports/dashboard/reactCMS/components/BlocksPage.jsx","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/dashboard/reactCMS/components/BlocksPage.jsx.map","sourceFileName":"imports/dashboard/reactCMS/components/BlocksPage.jsx","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"BlocksPage"},"ignored":false,"code":"let Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Mongo;\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 1);\nlet React, Component;\nmodule.watch(require(\"react\"), {\n  default(v) {\n    React = v;\n  },\n\n  Component(v) {\n    Component = v;\n  }\n\n}, 2);\nlet render;\nmodule.watch(require(\"react-dom\"), {\n  render(v) {\n    render = v;\n  }\n\n}, 3);\nlet TrackerReact;\nmodule.watch(require(\"meteor/ultimatejs:tracker-react\"), {\n  default(v) {\n    TrackerReact = v;\n  }\n\n}, 4);\nlet createContainer;\nmodule.watch(require(\"meteor/react-meteor-data\"), {\n  createContainer(v) {\n    createContainer = v;\n  }\n\n}, 5);\nlet Validation;\nmodule.watch(require(\"react-validation\"), {\n  default(v) {\n    Validation = v;\n  }\n\n}, 6);\nlet validator;\nmodule.watch(require(\"validator\"), {\n  default(v) {\n    validator = v;\n  }\n\n}, 7);\nlet Tracker;\nmodule.watch(require(\"meteor/tracker\"), {\n  Tracker(v) {\n    Tracker = v;\n  }\n\n}, 8);\nlet Blocks;\nmodule.watch(require(\"../api/Blocks\"), {\n  Blocks(v) {\n    Blocks = v;\n  }\n\n}, 9);\nlet TempBlockImages;\nmodule.watch(require(\"../api/Blocks\"), {\n  TempBlockImages(v) {\n    TempBlockImages = v;\n  }\n\n}, 10);\n\nclass BlocksPage extends TrackerReact(Component) {\n  constructor(props) {\n    super(props);\n    var metaContext = {\n      id: Meteor.userId(),\n      dir: \"images\",\n      name: \"blockImage\"\n    };\n    var uploader = new Slingshot.Upload(\"myFileUploads\", metaContext);\n    this.state = {\n      blockName: this.props.blocks,\n      blockBody: this.props.blocks,\n      id: this.props.blocks._id,\n      blocks: [],\n      upload: uploader,\n      isUploading: false,\n      progressValue: \"0%\",\n      tempBlockImages: [],\n      edit: false\n    };\n    this.handleChange = this.handleChange.bind(this);\n    console.log(\"id \" + this.state.id);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (!nextProps.loading) {\n      if (nextProps.blocks) {\n        this.setState({\n          blockName: nextProps.blocks.blockName,\n          blockBody: nextProps.blocks.blockBody,\n          id: nextProps.blocks._id\n        });\n      }\n    }\n\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  calculateProgress() {\n    this.uploadComputation = Tracker.autorun(() => {\n      const uploadProgress = Math.round(this.state.upload.progress() * 100);\n      if (!isNaN(uploadProgress)) this.setState({\n        progressValue: uploadProgress + \"%\"\n      });\n    });\n  }\n\n  handleChange(event) {\n    const target = event.target;\n    const name = target.name;\n    this.setState({\n      [name]: event.target.value\n    });\n  }\n\n  componentDidMount() {\n    if (!!!$(\"link[href='/css/dashboard.css']\").length > 0) {\n      var dashboardCss = document.createElement(\"link\");\n      dashboardCss.type = \"text/css\";\n      dashboardCss.rel = \"stylesheet\";\n      dashboardCss.href = \"/css/dashboard.css\";\n      document.head.append(dashboardCss);\n    }\n\n    if (!$(\"#adminLte\").length > 0 && !$('body').hasClass('adminLte')) {\n      console.log(\"I am appended!\");\n      var adminLte = document.createElement(\"script\");\n      adminLte.type = \"text/javascript\";\n      adminLte.src = \"/js/adminLte.js\";\n      adminLte.setAttribute('id', 'adminLte');\n      $(\"body\").append(adminLte);\n    }\n\n    $('#messageContent').summernote({\n      height: 190,\n      maxHeight: 190,\n      minHeight: 175\n    });\n    this.blockTracker = Tracker.autorun(() => {\n      Meteor.subscribe(\"blocks\");\n      const blocks = Blocks.find().fetch();\n      this.setState({\n        blocks: blocks\n      });\n    });\n    this.tempBlockImageTracker = Tracker.autorun(() => {\n      Meteor.subscribe('tempBlockImages');\n      const tempBlockImages = TempBlockImages.find().fetch();\n      this.setState({\n        tempBlockImages\n      });\n    }); // $(\".image-box\").css({'background-image':'url('+  $(\".image-box\").attr('data-image')+')','background-size': 'cover'});\n  }\n\n  componentWillUnmount() {\n    $(\"body\").find(\"script[src='/js/adminLte.js']\").remove();\n    const tempBlockImages = TempBlockImages.find().fetch();\n\n    for (i = 0; i < tempBlockImages.length; i++) {\n      if (!tempBlockImages[i].submitted) Meteor.call('removeS3Data', tempBlockImages[i].amazonUrl);\n    }\n\n    Meteor.call('removeBlockUnsubmitImages', Meteor.userId());\n    console.log('unmounted');\n    if (this.blockTracker) this.blockTracker.stop();\n    if (this.tempBlockImageTracker) this.tempBlockImageTracker.stop();\n  }\n\n  handleClose(e) {\n    e.preventDefault();\n    console.log('deleting ' + e.target.getAttribute('id'));\n\n    if (this.props.params.id && this.state.edit) {\n      Meteor.call('removeS3Data', e.target.getAttribute('id'));\n      Meteor.call('updateEditBlock', e.target.getAttribute('id'));\n    }\n\n    Meteor.call('removeBlockUrlImages', e.target.getAttribute('id'));\n    Meteor.call('removeS3Data', e.target.getAttribute('id'));\n  }\n\n  renderImageData() {\n    if (this.props.params.id && this.state.edit) {\n      const blocks = Blocks.find({\n        '_id': this.props.params.id\n      }).fetch();\n      var imageArray = [];\n\n      for (i = 0; i < blocks.length; i++) {\n        for (j = 0; j < blocks[i].s3.length; j++) {\n          if (blocks[i].s3[j].amazonUrl != '') {\n            imageArray.push(React.createElement(\n              \"div\",\n              {\n                key: j,\n                \"data-image\": blocks[i].s3[j].amazonUrl,\n                className: \"image-box\"\n              },\n              React.createElement(\"img\", {\n                src: blocks[i].s3[j].amazonUrl,\n                alt: \"\"\n              }),\n              React.createElement(\n                \"button\",\n                {\n                  id: blocks[i].s3[j].amazonUrl,\n                  className: \"close\",\n                  onClick: this.handleClose.bind(this)\n                },\n                React.createElement(\"i\", {\n                  className: \"ion ion-close-circled\"\n                })\n              )\n            ));\n          }\n        }\n      }\n\n      const tempBlockImages = TempBlockImages.find().fetch();\n\n      for (k = 0; k < tempBlockImages.length; k++) {\n        if (tempBlockImages[k].amazonUrl != '' && !tempBlockImages[k].submitted) imageArray.push(React.createElement(\n          \"div\",\n          {\n            \"data-image\": tempBlockImages[k].amazonUrl,\n            className: \"image-box\"\n          },\n          React.createElement(\"img\", {\n            src: tempBlockImages[k].amazonUrl,\n            alt: \"\"\n          }),\n          React.createElement(\n            \"button\",\n            {\n              id: tempBlockImages[k].amazonUrl,\n              className: \"close\",\n              onClick: this.handleClose.bind(this)\n            },\n            React.createElement(\"i\", {\n              className: \"ion ion-close-circled\"\n            })\n          )\n        ));\n      }\n\n      return imageArray;\n    } else {\n      const tempBlockImages = TempBlockImages.find().fetch();\n      return tempBlockImages.map(tempBlockImage => {\n        if (tempBlockImage.amazonUrl != '' && !tempBlockImage.submitted) return React.createElement(\n          \"div\",\n          {\n            \"data-image\": tempBlockImage.amazonUrl,\n            className: \"image-box\"\n          },\n          React.createElement(\"img\", {\n            src: tempBlockImage.amazonUrl,\n            alt: \"\"\n          }),\n          React.createElement(\n            \"button\",\n            {\n              id: tempBlockImage.amazonUrl,\n              className: \"close\",\n              onClick: this.handleClose.bind(this)\n            },\n            React.createElement(\"i\", {\n              className: \"ion ion-close-circled\"\n            })\n          )\n        );\n      });\n    }\n  }\n\n  handleUpload(e) {\n    let id = Meteor.userId();\n    e.preventDefault();\n    this.setState({\n      isUploading: true\n    });\n    this.calculateProgress();\n    var comp = this; // console.log(comp);\n\n    this.state.upload.send(document.getElementById('s3file').files[0], function (error, downloadUrl) {\n      if (error) {\n        // Log block detailed response.\n        console.error('Error uploading' + downloadUrl + error.reason);\n        console.error(error);\n      } else {\n        comp.setState({\n          progressValue: \"0%\"\n        });\n        comp.setState({\n          isUploading: false\n        });\n        comp.uploadComputation.stop();\n        console.log(\"Success file uploaded! \" + downloadUrl); // Meteor.users.update(Meteor.userId(), {$set: {\"profile.image\": downloadUrl}});\n\n        Meteor.call('uploadTempBlockImages', id, downloadUrl, new Date(), function (error, result) {\n          if (error) {\n            console.log(error.reason);\n          } else if (result) {\n            Bert.alert(\"Successfully Inserted..!!\");\n          }\n        });\n      }\n    });\n  }\n\n  handleUpdate(e) {\n    e.preventDefault();\n    this.setState({\n      edit: true\n    });\n    const tempBlockImages = TempBlockImages.find().fetch();\n    let pageName = this.refs.blockName.value;\n    let pageBody = $('#messageContent').summernote('code');\n    let userId = Meteor.userId();\n    let lastModified = new Date();\n    let id = e.target.getAttribute('id');\n    let amazons3 = [];\n\n    for (i = 0; i < tempBlockImages.length; i++) {\n      if (!tempBlockImages[i].submitted) {\n        amazons3.push({\n          'amazonUrl': tempBlockImages[i].amazonUrl,\n          'uploadTime': tempBlockImages[i].uploadTime\n        });\n      }\n\n      Meteor.call('updateTempBlockImages', tempBlockImages[i]._id, true);\n    }\n\n    Meteor.call('updateBlock', id, pageName, pageBody, userId, lastModified, function (error, result) {\n      if (error) {\n        console.log(error.reason);\n      } else if (result) {\n        Bert.alert(\"Successfully Updated..!!\");\n      }\n    });\n\n    for (j = 0; j < tempBlockImages.length; j++) {\n      if (!tempBlockImages[j].submitted) {\n        Meteor.call('updateBlockAmazonUrl', tempBlockImages[j].amazonUrl, tempBlockImages[j].uploadTime, id, function (error, result) {\n          if (error) {\n            console.log(error.reason);\n          } else if (result) {\n            Bert.alert(\"Successfully Updated..!!\");\n          }\n        });\n      }\n    }\n\n    Meteor.call('removeTempBlockImages', Meteor.userId());\n    swal(\"Done\", \"Your page has been Updated!.\", \"success\");\n    $(\".newTemplateForm\").css({\n      display: 'none'\n    });\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    const tempBlockImages = TempBlockImages.find().fetch();\n    let pageName = this.refs.blockName.value;\n    let pageBody = $('#messageContent').summernote('code');\n    let userId = Meteor.userId();\n    let lastModified = \"\";\n    let pageNameExist = Blocks.findOne({\n      'blockName': pageName\n    });\n    let amazons3 = [];\n    console.log(tempBlockImages.length);\n\n    for (i = 0; i < tempBlockImages.length; i++) {\n      if (!tempBlockImages[i].submitted) amazons3.push({\n        'amazonUrl': tempBlockImages[i].amazonUrl,\n        'uploadTime': tempBlockImages[i].uploadTime\n      });\n      Meteor.call('updateTempBlockImages', tempBlockImages[i]._id, true);\n    }\n\n    if (pageNameExist) {\n      swal(\"Oops...!\", \"This page name is already taken!\", \"error\");\n    } else {\n      Meteor.call('createBlock', pageName, pageBody, amazons3, userId, lastModified, function (error, result) {\n        if (error) {\n          console.log(error.reason);\n        } else if (result) {\n          Bert.alert(\"Successfully Inserted..!!\");\n        }\n      });\n    }\n\n    Meteor.call('removeTempBlockImages', Meteor.userId());\n    swal(\"Done\", \"Your page has been Created!.\", \"success\");\n    $(\".newTemplateForm\").css({\n      display: 'none'\n    });\n  }\n\n  edit(e) {\n    e.preventDefault();\n    this.setState({\n      'edit': true\n    });\n    const blocks = Blocks.find({\n      _id: this.props.params.id\n    }).fetch();\n    blocks.map(block => {\n      $(\"#blockName\").val(block.blockName);\n      $('.note-editable').html(block.blockBody);\n      $('.updatebtn').attr(\"id\", block._id);\n    });\n    $(\".updatebtn\").css({\n      display: 'block'\n    });\n    $(\".sendtxtmsgbtn\").css({\n      display: 'none'\n    });\n    $(\".newTemplateForm\").css({\n      display: 'block'\n    });\n  }\n\n  delete(e) {\n    e.preventDefault(); // console.log(e.target.getAttribute('id'));\n\n    let id = e.target.getAttribute('id');\n    swal({\n      title: \"Are you sure?\",\n      text: \"You want to delete this page!\",\n      type: \"warning\",\n      showCancelButton: true,\n      confirmButtonColor: \"#DD6B55\",\n      confirmButtonText: \"Yes, delete it!\",\n      closeOnConfirm: false,\n      html: false\n    }, function () {\n      Meteor.call(\"deleteBlock\", id, function (error, result) {\n        if (error) {\n          console.log(error.reason);\n        } else if (result) {\n          Bert.alert(\"Successfully Deleted..!!\");\n        }\n      });\n      swal(\"Done\", \"Your page has been deleted!.\", \"success\");\n    });\n    $(\".newTemplateForm\").css({\n      display: 'none'\n    });\n  }\n\n  renderTableRow() {\n    return this.state.blocks.map(block => {\n      return React.createElement(\n        \"tr\",\n        null,\n        React.createElement(\n          \"td\",\n          null,\n          \" \",\n          block.blockName,\n          \" \"\n        ),\n        React.createElement(\n          \"td\",\n          null,\n          React.createElement(\n            \"a\",\n            {\n              href: '/manageblock/' + block._id,\n              onClick: this.edit.bind(this)\n            },\n            React.createElement(\n              \"i\",\n              {\n                className: \"fa fa-pencil\"\n              },\n              \" \"\n            ),\n            \"Edit\"\n          )\n        ),\n        React.createElement(\n          \"td\",\n          null,\n          React.createElement(\n            \"a\",\n            {\n              href: \"#\",\n              id: block._id,\n              onClick: this.delete.bind(this)\n            },\n            React.createElement(\"i\", {\n              className: \"fa fa-trash-o\"\n            }),\n            \"Delete\"\n          )\n        )\n      );\n    });\n  }\n\n  render() {\n    return React.createElement(\n      \"div\",\n      null,\n      React.createElement(\n        \"div\",\n        {\n          className: \"content-wrapper\"\n        },\n        React.createElement(\n          \"section\",\n          {\n            className: \"content\"\n          },\n          React.createElement(\n            \"div\",\n            {\n              className: \"row\"\n            },\n            React.createElement(\n              \"div\",\n              {\n                className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12\"\n              },\n              React.createElement(\n                \"div\",\n                {\n                  className: \"box box-primary\"\n                },\n                React.createElement(\n                  \"div\",\n                  {\n                    className: \"box-header with-border\"\n                  },\n                  React.createElement(\n                    \"h3\",\n                    {\n                      className: \"box-title\"\n                    },\n                    \"Manage Blocks\"\n                  )\n                ),\n                React.createElement(\n                  \"div\",\n                  {\n                    className: \"box-body\"\n                  },\n                  React.createElement(\n                    \"div\",\n                    {\n                      className: \"row\"\n                    },\n                    React.createElement(\n                      \"div\",\n                      {\n                        className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12\"\n                      },\n                      React.createElement(\n                        \"div\",\n                        {\n                          className: \"notifWrapper col-lg-12 col-md-12 col-sm-12 col-xs-12\"\n                        },\n                        React.createElement(\n                          \"div\",\n                          {\n                            className: \"create-email-template-wrapper col-lg-12 col-md-12 col-sm-12 col-xs-12\"\n                          },\n                          React.createElement(\n                            \"form\",\n                            {\n                              className: \"newTemplateForm\"\n                            },\n                            \"    \",\n                            React.createElement(\n                              \"div\",\n                              {\n                                className: \"row inputrow\"\n                              },\n                              React.createElement(\n                                \"div\",\n                                {\n                                  className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12\"\n                                },\n                                React.createElement(\n                                  \"div\",\n                                  {\n                                    className: \"form-group\"\n                                  },\n                                  React.createElement(\n                                    \"label\",\n                                    {\n                                      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 label-category\"\n                                    },\n                                    \"Block Title\",\n                                    React.createElement(\n                                      \"span\",\n                                      {\n                                        className: \"astrick\"\n                                      },\n                                      \"*\"\n                                    ),\n                                    \":\"\n                                  ),\n                                  React.createElement(\"input\", {\n                                    type: \"text\",\n                                    ref: \"blockName\",\n                                    id: \"blockName\",\n                                    name: \"blockName\",\n                                    value: this.state.blockName,\n                                    onChange: this.handleChange,\n                                    className: \"templateName col-lg-12 col-md-12 col-sm-12 col-xs-12 inputValid\"\n                                  })\n                                )\n                              )\n                            ),\n                            React.createElement(\n                              \"div\",\n                              {\n                                className: \"row inputrow\"\n                              },\n                              React.createElement(\n                                \"div\",\n                                {\n                                  className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12\"\n                                },\n                                React.createElement(\n                                  \"div\",\n                                  {\n                                    className: \"form-group\"\n                                  },\n                                  React.createElement(\n                                    \"label\",\n                                    {\n                                      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 label-category\"\n                                    },\n                                    \"Description\",\n                                    React.createElement(\n                                      \"span\",\n                                      {\n                                        className: \"astrick\"\n                                      },\n                                      \"*\"\n                                    ),\n                                    \":\"\n                                  ),\n                                  React.createElement(\n                                    \"div\",\n                                    {\n                                      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 NOpadding\"\n                                    },\n                                    React.createElement(\"div\", {\n                                      id: \"messageContent\",\n                                      name: \"blockBody\",\n                                      ref: \"blockBody\"\n                                    })\n                                  )\n                                )\n                              )\n                            ),\n                            React.createElement(\n                              \"div\",\n                              {\n                                className: \"row inputrow subjectRow\"\n                              },\n                              React.createElement(\n                                \"div\",\n                                {\n                                  className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12\"\n                                },\n                                React.createElement(\n                                  \"div\",\n                                  {\n                                    className: \"form-group subjectDiv\"\n                                  },\n                                  React.createElement(\n                                    \"label\",\n                                    {\n                                      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 label-category\"\n                                    },\n                                    \"Image Upload\",\n                                    React.createElement(\n                                      \"span\",\n                                      {\n                                        className: \"astrick\"\n                                      },\n                                      \"*\"\n                                    ),\n                                    \":\"\n                                  ),\n                                  React.createElement(\"input\", {\n                                    type: \"file\",\n                                    ref: \"blogImageFile\",\n                                    id: \"s3file\",\n                                    name: \"blogImageFile\",\n                                    onChange: this.handleUpload.bind(this),\n                                    className: \"subject col-lg-12 col-md-12 col-sm-12 col-xs-12 inputValid\"\n                                  })\n                                )\n                              ),\n                              this.state.isUploading ? React.createElement(\n                                \"div\",\n                                null,\n                                React.createElement(\n                                  \"div\",\n                                  {\n                                    className: \"progress-sm\"\n                                  },\n                                  React.createElement(\n                                    \"div\",\n                                    {\n                                      className: \"progress-bar progress-bar-yellow\",\n                                      role: \"progressbar\",\n                                      \"data-width\": this.state.progressValue,\n                                      \"aria-valuemin\": \"0\",\n                                      \"aria-valuemax\": \"100\",\n                                      style: {\n                                        width: this.state.progressValue\n                                      }\n                                    },\n                                    React.createElement(\n                                      \"span\",\n                                      {\n                                        className: \"sr-only\"\n                                      },\n                                      this.state.progressValue,\n                                      \"% Complete\"\n                                    )\n                                  )\n                                )\n                              ) : React.createElement(\"div\", null)\n                            ),\n                            React.createElement(\n                              \"div\",\n                              {\n                                className: \"row inputrow subjectRow\"\n                              },\n                              React.createElement(\n                                \"div\",\n                                {\n                                  className: \"imageContainer\"\n                                },\n                                this.renderImageData()\n                              )\n                            ),\n                            React.createElement(\n                              \"div\",\n                              {\n                                className: \"savetemp col-lg-12 col-md-12 col-sm-12 col-xs-12\"\n                              },\n                              React.createElement(\n                                \"button\",\n                                {\n                                  onClick: this.handleSubmit.bind(this),\n                                  type: \"submit\",\n                                  className: \"col-lg-2 col-md-3 col-sm-6 col-xs-12 btn btn-primary pull-right sendtxtmsgbtn\"\n                                },\n                                \"Submit Page\"\n                              ),\n                              React.createElement(\n                                \"button\",\n                                {\n                                  onClick: this.handleUpdate.bind(this),\n                                  type: \"submit\",\n                                  className: \"btn btn-primary pull-right updatebtn col-lg-2 col-md-3 col-sm-6 col-xs-12\"\n                                },\n                                \"Update Page\"\n                              )\n                            )\n                          )\n                        ),\n                        React.createElement(\n                          \"div\",\n                          {\n                            className: \"dataTable tableBasicPage\"\n                          },\n                          React.createElement(\n                            \"table\",\n                            {\n                              className: \"heavyTable\",\n                              \"class\": \"display\",\n                              width: \"100%\",\n                              cellspacing: \"0\"\n                            },\n                            React.createElement(\n                              \"thead\",\n                              null,\n                              React.createElement(\n                                \"tr\",\n                                null,\n                                React.createElement(\n                                  \"th\",\n                                  null,\n                                  \"Block Title\"\n                                ),\n                                React.createElement(\"th\", null),\n                                React.createElement(\"th\", null)\n                              )\n                            ),\n                            React.createElement(\n                              \"tfoot\",\n                              null,\n                              React.createElement(\n                                \"tr\",\n                                null,\n                                React.createElement(\n                                  \"th\",\n                                  null,\n                                  \"Block Title\"\n                                ),\n                                React.createElement(\"th\", null),\n                                React.createElement(\"th\", null)\n                              )\n                            ),\n                            React.createElement(\n                              \"tbody\",\n                              null,\n                              this.renderTableRow()\n                            )\n                          )\n                        )\n                      )\n                    )\n                  )\n                )\n              )\n            )\n          )\n        )\n      )\n    );\n  }\n\n}\n\nEditPageContainer = createContainer(props => {\n  const postHandle = Meteor.subscribe('blocks'); // var editBlocks   = this.props.params.id;\n  // console.log(\"Param\" +editBlocks);\n\n  const blocks = Blocks.find().fetch() || {};\n  console.log(blocks);\n  const loading = !postHandle.ready();\n  return {\n    loading,\n    blocks\n  };\n}, BlocksPage);\nmodule.exportDefault(EditPageContainer);","map":{"version":3,"sources":["imports/dashboard/reactCMS/components/BlocksPage.jsx"],"names":["Meteor","module","watch","require","v","Mongo","React","Component","default","render","TrackerReact","createContainer","Validation","validator","Tracker","Blocks","TempBlockImages","BlocksPage","constructor","props","metaContext","id","userId","dir","name","uploader","Slingshot","Upload","state","blockName","blocks","blockBody","_id","upload","isUploading","progressValue","tempBlockImages","edit","handleChange","bind","console","log","componentWillReceiveProps","nextProps","loading","setState","calculateProgress","uploadComputation","autorun","uploadProgress","Math","round","progress","isNaN","event","target","value","componentDidMount","$","length","dashboardCss","document","createElement","type","rel","href","head","append","hasClass","adminLte","src","setAttribute","summernote","height","maxHeight","minHeight","blockTracker","subscribe","find","fetch","tempBlockImageTracker","componentWillUnmount","remove","i","submitted","call","amazonUrl","stop","handleClose","e","preventDefault","getAttribute","params","renderImageData","imageArray","j","s3","push","k","map","tempBlockImage","handleUpload","comp","send","getElementById","files","error","downloadUrl","reason","Date","result","Bert","alert","handleUpdate","pageName","refs","pageBody","lastModified","amazons3","uploadTime","swal","css","display","handleSubmit","pageNameExist","findOne","block","val","html","attr","delete","title","text","showCancelButton","confirmButtonColor","confirmButtonText","closeOnConfirm","renderTableRow","width","EditPageContainer","postHandle","ready","exportDefault"],"mappings":"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","file":"imports/dashboard/reactCMS/components/BlocksPage.jsx.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport TrackerReact from 'meteor/ultimatejs:tracker-react';\nimport { createContainer } from 'meteor/react-meteor-data';\nimport Validation from 'react-validation';\nimport validator from 'validator';\nimport {Tracker} from 'meteor/tracker';\n\nimport {Blocks} from '../api/Blocks';\nimport {TempBlockImages} from '../api/Blocks';\n\nclass BlocksPage extends TrackerReact (Component){\n  constructor(props) {\n    super(props);\n    var metaContext = {id: Meteor.userId(), dir: \"images\" , name: \"blockImage\"};\n    var uploader = new Slingshot.Upload(\"myFileUploads\" ,metaContext);\n    this.state = {\n      blockName       : this.props.blocks,\n      blockBody       : this.props.blocks,\n      id                : this.props.blocks._id,\n      blocks          : [],\n      upload            : uploader,\n      isUploading       : false,\n      progressValue     : \"0%\",\n      tempBlockImages : [],\n      edit              : false,\n    };\n  this.handleChange = this.handleChange.bind(this);\n  console.log(\"id \" + this.state.id);\n  }\n  componentWillReceiveProps(nextProps) {\n    if(!nextProps.loading){\n      if(nextProps.blocks){\n         this.setState({\n             blockName     : nextProps.blocks.blockName,\n             blockBody     : nextProps.blocks.blockBody,\n             id               : nextProps.blocks._id,\n         });\n      }\n    }\n\n    this.handleChange = this.handleChange.bind(this);\n  }\n  calculateProgress(){\n    this.uploadComputation = Tracker.autorun(() => {\n         const uploadProgress = Math.round(this.state.upload.progress() * 100);\n         if (!isNaN(uploadProgress)) this.setState({progressValue: uploadProgress +\"%\" });\n    });\n  }\n  handleChange(event){\n   const target = event.target;\n   const name   = target.name;\n   this.setState({\n    [name]: event.target.value,\n   });\n  }\n  componentDidMount() {\n    if(!!!$(\"link[href='/css/dashboard.css']\").length > 0){\n      var dashboardCss = document.createElement(\"link\");\n      dashboardCss.type=\"text/css\";\n      dashboardCss.rel =\"stylesheet\";\n      dashboardCss.href=\"/css/dashboard.css\";\n      document.head.append(dashboardCss);\n    }\n    if (!$(\"#adminLte\").length>0 && !$('body').hasClass('adminLte')) {\n      console.log(\"I am appended!\");\n      var adminLte = document.createElement(\"script\");\n      adminLte.type = \"text/javascript\";\n      adminLte.src = \"/js/adminLte.js\";\n      adminLte.setAttribute('id','adminLte');\n      $(\"body\").append(adminLte);\n    }\n    $('#messageContent').summernote({\n        height: 190,\n        maxHeight:190,\n        minHeight:175,\n      });\n    this.blockTracker = Tracker.autorun( ()=> {\n      Meteor.subscribe(\"blocks\");\n      const blocks = Blocks.find().fetch();\n      this.setState({blocks: blocks});\n    });\n    this.tempBlockImageTracker = Tracker.autorun(()=>{\n      Meteor.subscribe('tempBlockImages');\n      const tempBlockImages = TempBlockImages.find().fetch();\n      this.setState({tempBlockImages});\n    });\n    // $(\".image-box\").css({'background-image':'url('+  $(\".image-box\").attr('data-image')+')','background-size': 'cover'});\n  }\n  componentWillUnmount() {\n    $(\"body\").find(\"script[src='/js/adminLte.js']\").remove();\n    const tempBlockImages = TempBlockImages.find().fetch();\n    for(i=0;i<tempBlockImages.length;i++){\n      if(!tempBlockImages[i].submitted)\n        Meteor.call('removeS3Data',tempBlockImages[i].amazonUrl);\n    }\n    Meteor.call('removeBlockUnsubmitImages',Meteor.userId());\n    console.log('unmounted');\n    if(this.blockTracker)\n      this.blockTracker.stop();\n    if(this.tempBlockImageTracker)\n      this.tempBlockImageTracker.stop();\n  }\n  handleClose(e){\n    e.preventDefault();\n    console.log('deleting ' + e.target.getAttribute('id'));\n    if(this.props.params.id && this.state.edit){\n      Meteor.call('removeS3Data',e.target.getAttribute('id'));\n      Meteor.call('updateEditBlock',e.target.getAttribute('id'));\n    }\n    Meteor.call('removeBlockUrlImages',e.target.getAttribute('id'));\n    Meteor.call('removeS3Data',e.target.getAttribute('id'));\n  }\n  renderImageData(){\n    if(this.props.params.id && this.state.edit){\n      const blocks = Blocks.find({'_id': this.props.params.id}).fetch();\n      var imageArray =[];\n      for(i=0;i<blocks.length;i++){\n        for(j=0;j<blocks[i].s3.length; j++){\n          if(blocks[i].s3[j].amazonUrl != ''){\n            imageArray.push(\n            <div key={j} data-image={blocks[i].s3[j].amazonUrl} className=\"image-box\">\n              <img src={blocks[i].s3[j].amazonUrl} alt=\"\"/><button id={blocks[i].s3[j].amazonUrl} className=\"close\" onClick={this.handleClose.bind(this)}><i className=\"ion ion-close-circled\"></i></button></div>);\n          }\n        }\n      }\n      const tempBlockImages = TempBlockImages.find().fetch();\n      for(k=0;k<tempBlockImages.length;k++){\n        if(tempBlockImages[k].amazonUrl != ''&& !tempBlockImages[k].submitted)\n          imageArray.push(\n            <div data-image={tempBlockImages[k].amazonUrl} className=\"image-box\">\n              <img src={tempBlockImages[k].amazonUrl} alt=\"\"/><button id={tempBlockImages[k].amazonUrl} className=\"close\" onClick={this.handleClose.bind(this)}><i className=\"ion ion-close-circled\"></i></button></div>\n          );\n      }\n      return imageArray;\n  }else{\n      const tempBlockImages = TempBlockImages.find().fetch();\n      return tempBlockImages.map((tempBlockImage)=>{\n        if(tempBlockImage.amazonUrl != ''&& !tempBlockImage.submitted)\n          return <div data-image={tempBlockImage.amazonUrl} className=\"image-box\">\n            <img src={tempBlockImage.amazonUrl} alt=\"\"/><button id={tempBlockImage.amazonUrl} className=\"close\" onClick={this.handleClose.bind(this)}><i className=\"ion ion-close-circled\"></i></button></div>;\n      });\n    }\n}\n  handleUpload(e) {\n      let id = Meteor.userId();\n      e.preventDefault();\n      this.setState({isUploading: true});\n      this.calculateProgress();\n      var comp = this;\n      // console.log(comp);\n      this.state.upload.send(document.getElementById('s3file').files[0], function (error, downloadUrl) {\n        if (error) {\n          // Log block detailed response.\n          console.error('Error uploading' + downloadUrl + error.reason);\n          console.error (error);\n        }\n        else {\n          comp.setState({progressValue:\"0%\"});\n          comp.setState({isUploading:false});\n          comp.uploadComputation.stop();\n          console.log(\"Success file uploaded! \" + downloadUrl);\n          // Meteor.users.update(Meteor.userId(), {$set: {\"profile.image\": downloadUrl}});\n          Meteor.call('uploadTempBlockImages',id,downloadUrl,new Date(), function(error,result){\n              if(error){\n                  console.log(error.reason);\n              }else if(result){\n                  Bert.alert(\"Successfully Inserted..!!\");\n              }\n          });\n        }\n      });\n    }\n  handleUpdate(e){\n    e.preventDefault();\n    this.setState({edit:true});\n    const tempBlockImages  = TempBlockImages.find().fetch();\n    let pageName      = this.refs.blockName.value;\n    let pageBody      = $('#messageContent').summernote('code');\n    let userId        = Meteor.userId();\n    let lastModified  = new Date();\n    let id            = e.target.getAttribute('id');\n    let amazons3      = [];\n    for(i=0;i<tempBlockImages.length;i++){\n      if(!tempBlockImages[i].submitted){\n        amazons3.push({\n          'amazonUrl': tempBlockImages[i].amazonUrl,\n          'uploadTime': tempBlockImages[i].uploadTime,\n        });\n      }\n      Meteor.call('updateTempBlockImages',tempBlockImages[i]._id,true);\n    }\n    Meteor.call('updateBlock',id,pageName,pageBody,userId,lastModified,function(error,result){\n        if(error){\n            console.log(error.reason);\n        }else if(result){\n            Bert.alert(\"Successfully Updated..!!\");\n        }\n    });\n    for(j=0;j<tempBlockImages.length;j++){\n      if(!tempBlockImages[j].submitted){\n        Meteor.call('updateBlockAmazonUrl',tempBlockImages[j].amazonUrl,tempBlockImages[j].uploadTime,id,function(error,result){\n            if(error){\n                console.log(error.reason);\n            }else if(result){\n                Bert.alert(\"Successfully Updated..!!\");\n            }\n        });\n      }\n    }\n\n    Meteor.call('removeTempBlockImages',Meteor.userId());\n    swal(\"Done\",\n    \"Your page has been Updated!.\",\n    \"success\");\n    $(\".newTemplateForm\").css({display:'none'});\n  }\n  handleSubmit(e){\n      e.preventDefault();\n      const tempBlockImages = TempBlockImages.find().fetch();\n      let pageName = this.refs.blockName.value;\n      let pageBody = $('#messageContent').summernote('code');\n      let userId = Meteor.userId();\n      let lastModified = \"\";\n      let pageNameExist = Blocks.findOne({'blockName': pageName});\n      let amazons3 = [];\n      console.log(tempBlockImages.length);\n      for(i=0;i<tempBlockImages.length;i++){\n        if(!tempBlockImages[i].submitted)\n          amazons3.push({\n            'amazonUrl': tempBlockImages[i].amazonUrl,\n            'uploadTime': tempBlockImages[i].uploadTime,\n          });\n        Meteor.call('updateTempBlockImages',tempBlockImages[i]._id,true);\n      }\n      if(pageNameExist){\n          swal(\"Oops...!\",\"This page name is already taken!\",\"error\");\n      }else{\n          Meteor.call('createBlock',pageName,pageBody,amazons3,userId,lastModified,function(error,result){\n              if(error){\n                  console.log(error.reason);\n              }else if(result){\n                  Bert.alert(\"Successfully Inserted..!!\");\n              }\n          });\n      }\n      Meteor.call('removeTempBlockImages',Meteor.userId());\n      swal(\"Done\",\n      \"Your page has been Created!.\",\n      \"success\");\n        $(\".newTemplateForm\").css({display:'none'});\n  }\n  edit(e){\n    e.preventDefault();\n    this.setState({'edit': true});\n    const blocks = Blocks.find({_id: this.props.params.id}).fetch();\n    blocks.map((block)=>{\n      $(\"#blockName\").val(block.blockName);\n      $('.note-editable').html(block.blockBody);\n      $('.updatebtn').attr(\"id\",block._id);\n    });\n    $(\".updatebtn\").css({display:'block'});\n    $(\".sendtxtmsgbtn\").css({display:'none'});\n    $(\".newTemplateForm\").css({display:'block'});\n\n  }\n  delete(e){\n    e.preventDefault();\n    // console.log(e.target.getAttribute('id'));\n    let id = e.target.getAttribute('id');\n    swal({\n      title: \"Are you sure?\",\n      text: \"You want to delete this page!\",\n      type: \"warning\",\n      showCancelButton: true,\n      confirmButtonColor: \"#DD6B55\",\n      confirmButtonText: \"Yes, delete it!\",\n      closeOnConfirm: false,\n      html: false\n    }, function(){\n      Meteor.call(\"deleteBlock\",id,function(error,result){\n          if(error){\n              console.log(error.reason);\n          }else if(result){\n              Bert.alert(\"Successfully Deleted..!!\");\n          }\n      });\n      swal(\"Done\",\n      \"Your page has been deleted!.\",\n      \"success\");\n    });\n      $(\".newTemplateForm\").css({display:'none'});\n  }\n\n  renderTableRow(){\n    return this.state.blocks.map((block) =>{\n      return <tr>\n              <td> {block.blockName} </td>\n              <td>\n                <a href={'/manageblock/' +block._id} onClick={this.edit.bind(this)}>\n                  <i className = \"fa fa-pencil\" > </i>\n                  Edit\n                </a>\n              </td>\n              <td>\n                <a href=\"#\" id={block._id} onClick={this.delete.bind(this)}>\n                  <i className=\"fa fa-trash-o\"></i>\n                  Delete\n                </a>\n              </td>\n            </tr>;\n      });\n  }\n  render(){\n    return(\n      <div>\n        {/* Content Wrapper. Contains page content */}\n        <div className=\"content-wrapper\">\n          {/* Content Header (Page header) */}\n          {/* Main content */}\n          <section className=\"content\">\n            <div className=\"row\">\n              <div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n                <div className=\"box box-primary\">\n                  <div className=\"box-header with-border\">\n                    <h3 className=\"box-title\">\n                      Manage Blocks\n                    </h3>\n                    {/*<div className=\"box-tools pull-right\">\n                      <button type=\"button\" className=\"btn btn-box-tool btn-minus\" data-widget=\"collapse\">\n                        <i className=\"fa fa-minus\" />\n                      </button>\n                      <div className=\"btn-group\">\n                        <button type=\"button\" className=\"btn btn-box-tool dropdown-toggle\" data-toggle=\"dropdown\">\n                          <i className=\"fa fa-wrench\" /></button>\n                        <ul className=\"dropdown-menu\" role=\"menu\">\n                          <li>\n                            <a href=\"#\">Action</a>\n                          </li>\n                          <li>\n                            <a href=\"#\">Another action </a>\n                          </li>\n                          <li>\n                            <a href=\"#\">Something else here</a>\n                          </li>\n                          <li className=\"divider\" />\n                          <li>\n                            <a href=\"#\">\n                            Separated link\n                            </a>\n                          </li>\n                        </ul>\n                      </div>\n                      <button type=\"button\" className=\"btn btn-box-tool\" data-widget=\"remove\">\n                        <i className=\"fa fa-times\" />\n                      </button>\n                    </div>*/}\n                  </div>\n                  {/* /.box-header */}\n                  <div className=\"box-body\">\n                    <div className=\"row\">\n                      <div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n                        <div className=\"notifWrapper col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n                          <div className=\"create-email-template-wrapper col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n                            <form className=\"newTemplateForm\">    <div className=\"row inputrow\">\n                                <div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n                                  <div className=\"form-group\">\n                                   <label className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 label-category\">Block Title<span className=\"astrick\">*</span>:</label>\n                                        <input type=\"text\" ref=\"blockName\" id=\"blockName\" name=\"blockName\" value={this.state.blockName}  onChange={this.handleChange} className=\"templateName col-lg-12 col-md-12 col-sm-12 col-xs-12 inputValid\" />\n                                  </div>\n                                </div>\n                              </div>\n                              <div className=\"row inputrow\">\n                                <div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n                                  <div className=\"form-group\">\n                                   <label className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 label-category\">Description<span className=\"astrick\">*</span>:</label>\n                                   <div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 NOpadding\">\n                                    <div id=\"messageContent\" name=\"blockBody\"\n                                                        ref = \"blockBody\"\n                                                            ></div>\n                                   </div>\n                                  </div>\n                                </div>\n                              </div>\n                              <div className=\"row inputrow subjectRow\">\n                                <div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n                                  <div className=\"form-group subjectDiv\">\n                                   <label className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 label-category\">Image Upload<span className=\"astrick\">*</span>:</label>\n                                        <input type=\"file\" ref=\"blogImageFile\" id=\"s3file\" name=\"blogImageFile\"  onChange={this.handleUpload.bind(this)}  className=\"subject col-lg-12 col-md-12 col-sm-12 col-xs-12 inputValid\" />\n                                  </div>\n                                </div>\n                                {this.state.isUploading?\n                                  <div><div className=\"progress-sm\">\n                                    <div className=\"progress-bar progress-bar-yellow\" role=\"progressbar\" data-width={this.state.progressValue} aria-valuemin=\"0\" aria-valuemax=\"100\" style={{width:this.state.progressValue} } >\n                                        <span className=\"sr-only\">{this.state.progressValue}% Complete\n                                        </span>\n                                      </div>\n                                    </div>\n                                  </div>: <div></div>}\n                              </div>\n                              <div className=\"row inputrow subjectRow\">\n                                <div className=\"imageContainer\">\n                                  {this.renderImageData()}\n                                </div>\n                              </div>\n\n                              <div className=\"savetemp col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n                                <button onClick={this.handleSubmit.bind(this)} type=\"submit\" className=\"col-lg-2 col-md-3 col-sm-6 col-xs-12 btn btn-primary pull-right sendtxtmsgbtn\">Submit Page</button>\n                                <button  onClick={this.handleUpdate.bind(this)} type=\"submit\" className=\"btn btn-primary pull-right updatebtn col-lg-2 col-md-3 col-sm-6 col-xs-12\">Update Page</button>\n                              </div>\n                            </form>\n                          </div>\n                          <div className=\"dataTable tableBasicPage\">\n                              <table className=\"heavyTable\"  class=\"display\" width=\"100%\" cellspacing=\"0\">\n                                  <thead>\n                                      <tr>\n                                          <th>Block Title</th>\n                                          <th></th>\n                                          <th></th>\n                                      </tr>\n                                  </thead>\n                                  <tfoot>\n                                      <tr>\n                                        <th>Block Title</th>\n                                        <th></th>\n                                        <th></th>\n                                      </tr>\n                                  </tfoot>\n                                  <tbody>\n                                          {this.renderTableRow()}\n                                  </tbody>\n                              </table>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </section>\n          {/* /.content */}\n        </div>\n        {/* /.content-wrapper */}\n      </div>\n\n    );\n  }\n}\nEditPageContainer = createContainer( props => {\n\n    const postHandle = Meteor.subscribe('blocks');\n    // var editBlocks   = this.props.params.id;\n    // console.log(\"Param\" +editBlocks);\n    const blocks = Blocks.find().fetch()|| {};\n    console.log(blocks);\n    const loading = !postHandle.ready();\n\n    return {\n        loading,\n        blocks,\n    };\n}, BlocksPage);\n\nexport default EditPageContainer;\n"]},"hash":"200101eb692edc944092d497bf26ca5a24c34a67"}
