{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"react","imported":["default","Component"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"Component","local":"Component"}]},{"source":"react-dom","imported":["render"],"specifiers":[{"kind":"named","imported":"render","local":"render"}]},{"source":"meteor/ultimatejs:tracker-react","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"TrackerReact"}]},{"source":"meteor/react-meteor-data","imported":["createContainer"],"specifiers":[{"kind":"named","imported":"createContainer","local":"createContainer"}]},{"source":"meteor/email","imported":["Email"],"specifiers":[{"kind":"named","imported":"Email","local":"Email"}]},{"source":"../api/NotificationTemplate.js","imported":["NotificationTemplate"],"specifiers":[{"kind":"named","imported":"NotificationTemplate","local":"NotificationTemplate"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/dashboard/notification/components/SendMailnNotification.jsx","filenameRelative":"imports/dashboard/notification/components/SendMailnNotification.jsx","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/dashboard/notification/components/SendMailnNotification.jsx.map","sourceFileName":"imports/dashboard/notification/components/SendMailnNotification.jsx","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"SendMailnNotification"},"ignored":false,"code":"var React = void 0,\n    Component = void 0;\nmodule.watch(require(\"react\"), {\n\t\"default\": function (v) {\n\t\tReact = v;\n\t},\n\tComponent: function (v) {\n\t\tComponent = v;\n\t}\n}, 0);\nvar render = void 0;\nmodule.watch(require(\"react-dom\"), {\n\trender: function (v) {\n\t\trender = v;\n\t}\n}, 1);\nvar TrackerReact = void 0;\nmodule.watch(require(\"meteor/ultimatejs:tracker-react\"), {\n\t\"default\": function (v) {\n\t\tTrackerReact = v;\n\t}\n}, 2);\nvar createContainer = void 0;\nmodule.watch(require(\"meteor/react-meteor-data\"), {\n\tcreateContainer: function (v) {\n\t\tcreateContainer = v;\n\t}\n}, 3);\nvar Email = void 0;\nmodule.watch(require(\"meteor/email\"), {\n\tEmail: function (v) {\n\t\tEmail = v;\n\t}\n}, 4);\nvar NotificationTemplate = void 0;\nmodule.watch(require(\"../api/NotificationTemplate.js\"), {\n\tNotificationTemplate: function (v) {\n\t\tNotificationTemplate = v;\n\t}\n}, 5);\n\nsendMailNotification = function (inputObj) {\n\tif (inputObj) {\n\t\t//============================================================\n\t\t//  Mail Function\n\t\t//============================================================\n\t\tvar fromId = getMailId(inputObj.from);\n\t\tvar to = getMailId(inputObj.to);\n\t\tvar subject = getSubject(inputObj.templateName);\n\t\tvar body = getMessageContent(inputObj.templateName, inputObj.variables);\n\t\tconsole.log(\"from: \" + fromId);\n\t\tconsole.log(\"to: \" + to);\n\t\tconsole.log(\"subject: \" + subject);\n\t\tconsole.log(\"body: \" + body);\n\t\tMeteor.call('sendEmailnNotification', to, fromId, subject, body, function (error, result) {\n\t\t\tif (error) {\n\t\t\t\tBert.alert(error, 'danger', 'growl-top-right');\n\t\t\t} else {\n\t\t\t\tconsole.log('Mail Sent', 'success', 'growl-top-right');\n\t\t\t}\n\t\t});\n\t} // if inputObj\n\n};\n\nsendInAppNotification = function (inputObj) {\n\tif (inputObj) {\n\t\t//============================================================\n\t\t//  Notification Function\n\t\t//============================================================\n\t\tvar notifBody = getNotificationContent(inputObj.templateName, inputObj.variables);\n\t\tvar toMailId = getMailId(inputObj.to);\n\t\tvar toUserId = inputObj.to;\n\t\tvar templateName = inputObj.templateName; // console.log(\"notifBody: \"+notifBody);\n\t\t// console.log(\"to: \"+toUserId);\n\n\t\tMeteor.call('insertNotification', templateName, toMailId, toUserId, notifBody, function (error, result) {\n\t\t\tif (error) {\n\t\t\t\tconsole.log(error, 'danger', 'growl-top-right');\n\t\t\t} else if (result) {\n\t\t\t\tconsole.log(\"Notification sent\", 'success', 'growl-top-right');\n\t\t\t}\n\t\t}); // end of insertNotification\n\t} // if inputObj\n\n};\n\nsendSMS = function (inputObj) {\n\tif (inputObj) {\n\t\t//============================================================\n\t\t//  Notification Function\n\t\t//============================================================\n\t\tvar smsBody = getSMSContent(inputObj.templateName, inputObj.variables);\n\t\tvar toUserId = inputObj.to;\n\t\tvar toNumber = inputObj.number; // console.log(\"smsBody: \"+smsBody);\n\t\t// console.log(\"to: \"+toUserId);\n\t\t// console.log(\"toNumber: \"+toNumber);\n\n\t\tMeteor.call('sendSMS', toNumber, smsBody, function (error, result) {\n\t\t\tif (error) {\n\t\t\t\tconsole.log(error);\n\t\t\t} else {\n\t\t\t\tconsole.log('SMS sent');\n\t\t\t\tMeteor.call('insertSMS', toUserId, smsBody, toNumber, function (error, result) {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tconsole.log(error, 'danger', 'growl-top-right');\n\t\t\t\t\t} else if (result) {\n\t\t\t\t\t\tconsole.log(\"SMS sent\", 'success', 'growl-top-right');\n\t\t\t\t\t}\n\t\t\t\t}); // end of insertSMS\n\t\t\t}\n\t\t});\n\t} // if inputObj\n\n};\n\ngetMailId = function (to, templateName) {\n\tvar userData = Meteor.users.findOne({\n\t\t'_id': to\n\t});\n\n\tif (userData) {\n\t\tvar emailAddress = userData.emails[0].address;\n\t} //userData\n\n\n\treturn emailAddress;\n};\n\ngetSubject = function (templateName) {\n\tvar NotificationData = NotificationTemplate.findOne({\n\t\t'templateName': templateName\n\t});\n\n\tif (NotificationData) {\n\t\tvar subject = NotificationData.subject;\n\t} //NotificationData\n\n\n\treturn subject;\n};\n\ngetMessageContent = function (templateName, varObj) {\n\t// get all content from templatename\n\tvar NotificationData = NotificationTemplate.findOne({\n\t\t\"templateType\": \"Email\",\n\t\t'templateName': templateName\n\t});\n\n\tif (NotificationData) {\n\t\tvar content = NotificationData.content;\n\t\tcontent = content.replace(\"<p>\", \"<div>\");\n\t\tcontent = content.replace(\"</p>\", \"</div>\");\n\t\tcontent = content.replace(\"&nbsp;\", \" \");\n\t\tvar words = content.split(' ');\n\t\tvar tokens = [];\n\t\tvar n = 0;\n\n\t\tfor (i = 0; i < words.length; i++) {\n\t\t\tif (words[i].charAt(0) == '[') {\n\t\t\t\ttokens[n] = words[i];\n\n\t\t\t\tif (tokens[n].substr(tokens[n].length - 1) != ']') {\n\t\t\t\t\ttokens[n] = tokens[n].substr(0, tokens[n].length - 1);\n\t\t\t\t}\n\n\t\t\t\tn++;\n\t\t\t}\n\t\t}\n\n\t\tvar numOfVar = Object.keys(varObj).length;\n\n\t\tfor (i = 0; i < numOfVar; i++) {\n\t\t\tcontent = content.replace(tokens[i], varObj[tokens[i]]);\n\t\t}\n\t} //NotificationData\n\n\n\treturn content;\n};\n\ngetSMSContent = function (templateName, varObj) {\n\t// get all content from templatename\n\tvar NotificationData = NotificationTemplate.findOne({\n\t\t\"templateType\": \"SMS\",\n\t\t'templateName': templateName\n\t});\n\n\tif (NotificationData) {\n\t\tvar content = NotificationData.content;\n\t\tcontent = content.replace(\"<p>\", \"<div>\");\n\t\tcontent = content.replace(\"</p>\", \"</div>\");\n\t\tcontent = content.replace(\"&nbsp;\", \" \");\n\t\tvar words = content.split(' ');\n\t\tvar tokens = [];\n\t\tvar n = 0;\n\n\t\tfor (i = 0; i < words.length; i++) {\n\t\t\tif (words[i].charAt(0) == '[') {\n\t\t\t\ttokens[n] = words[i];\n\n\t\t\t\tif (tokens[n].substr(tokens[n].length - 1) != ']') {\n\t\t\t\t\ttokens[n] = tokens[n].substr(0, tokens[n].length - 1);\n\t\t\t\t}\n\n\t\t\t\tn++;\n\t\t\t}\n\t\t}\n\n\t\tvar numOfVar = Object.keys(varObj).length;\n\n\t\tfor (i = 0; i < numOfVar; i++) {\n\t\t\tcontent = content.replace(tokens[i], varObj[tokens[i]]);\n\t\t}\n\t} //NotificationData\n\n\n\treturn content;\n};\n\ngetNotificationContent = function (templateName, varObj) {\n\tvar NotificationData = NotificationTemplate.findOne({\n\t\t\"templateType\": \"Notification\",\n\t\t'templateName': templateName\n\t});\n\n\tif (NotificationData) {\n\t\tvar content = NotificationData.content;\n\t\tcontent = content.replace(\"<p>\", \"<div>\");\n\t\tcontent = content.replace(\"</p>\", \"</div>\");\n\t\tcontent = content.replace(\"&nbsp;\", \" \");\n\t\tvar words = content.split(' ');\n\t\tvar tokens = [];\n\t\tvar n = 0;\n\n\t\tfor (i = 0; i < words.length; i++) {\n\t\t\tif (words[i].charAt(0) == '[') {\n\t\t\t\ttokens[n] = words[i];\n\n\t\t\t\tif (tokens[n].substr(tokens[n].length - 1) != ']') {\n\t\t\t\t\ttokens[n] = tokens[n].substr(0, tokens[n].length - 1);\n\t\t\t\t}\n\n\t\t\t\tn++;\n\t\t\t}\n\t\t}\n\n\t\tvar numOfVar = Object.keys(varObj).length;\n\n\t\tfor (i = 0; i < numOfVar; i++) {\n\t\t\tcontent = content.replace(tokens[i], varObj[tokens[i]]);\n\t\t}\n\t} //NotificationData\n\n\n\treturn content;\n};","map":{"version":3,"sources":["imports/dashboard/notification/components/SendMailnNotification.jsx"],"names":["React","Component","module","watch","require","v","render","TrackerReact","createContainer","Email","NotificationTemplate","sendMailNotification","inputObj","fromId","getMailId","from","to","subject","getSubject","templateName","body","getMessageContent","variables","console","log","Meteor","call","error","result","Bert","alert","sendInAppNotification","notifBody","getNotificationContent","toMailId","toUserId","sendSMS","smsBody","getSMSContent","toNumber","number","userData","users","findOne","emailAddress","emails","address","NotificationData","varObj","content","replace","words","split","tokens","n","i","length","charAt","substr","numOfVar","Object","keys"],"mappings":"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","file":"imports/dashboard/notification/components/SendMailnNotification.jsx.map","sourcesContent":["import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport TrackerReact from 'meteor/ultimatejs:tracker-react';\nimport {createContainer} from 'meteor/react-meteor-data';\nimport { Email } from 'meteor/email';\n\nimport { NotificationTemplate } from '../api/NotificationTemplate.js';\n\n\nsendMailNotification = function(inputObj) {\n\tif(inputObj){\n\t//============================================================\n\t//  Mail Function\n\t//============================================================\n\n\tvar fromId \t= getMailId(inputObj.from);\n\tvar to \t\t= getMailId(inputObj.to);  \n\tvar subject\t= getSubject(inputObj.templateName);\n\tvar body\t= getMessageContent(inputObj.templateName,inputObj.variables);\n\n\tconsole.log(\"from: \"+fromId);\n\tconsole.log(\"to: \"+to);\n\tconsole.log(\"subject: \"+subject);\n\tconsole.log(\"body: \"+body);\n\n\tMeteor.call('sendEmailnNotification',to, fromId, subject, body,function(error,result){\n\t\tif(error){\n\t\t\tBert.alert(error,'danger', 'growl-top-right');\n\t\t}else{\n\t\t\tconsole.log('Mail Sent','success', 'growl-top-right');\n\t\t\t\t\n\t\t\t}\n\n\t});\n\t} // if inputObj\n\n}\n\nsendInAppNotification = function(inputObj) {\n\tif(inputObj){\n\n\t//============================================================\n\t//  Notification Function\n\t//============================================================\n\n\t\tvar notifBody    = getNotificationContent(inputObj.templateName,inputObj.variables);\n\t\tvar toMailId     = getMailId(inputObj.to); \n\t\tvar toUserId     = inputObj.to;\n\t\tvar templateName = inputObj.templateName;\n\n\t\t// console.log(\"notifBody: \"+notifBody);\n\t\t// console.log(\"to: \"+toUserId);\n\n\t\tMeteor.call('insertNotification',templateName,toMailId,toUserId,notifBody,function(error,result){\n\t\t\tif(error){\n\t\t\t\tconsole.log(error,'danger', 'growl-top-right');\n\t\t\t}else if(result){\n\t\t\t\tconsole.log(\"Notification sent\",'success', 'growl-top-right');\n\n\t\t\t}\n\t\t}); // end of insertNotification\n\t} // if inputObj\n\n}\n\nsendSMS = function(inputObj) {\n\tif(inputObj){\n\n\t//============================================================\n\t//  Notification Function\n\t//============================================================\n\n\t\tvar smsBody    = getSMSContent(inputObj.templateName,inputObj.variables);\n\t\tvar toUserId   = inputObj.to;\n\t\tvar toNumber   = inputObj.number;\n\n\t\t// console.log(\"smsBody: \"+smsBody);\n\t\t// console.log(\"to: \"+toUserId);\n\t\t// console.log(\"toNumber: \"+toNumber);\n\n\t\tMeteor.call('sendSMS',toNumber,smsBody,function(error,result){\n\t\t\tif(error){\n\t\t\t\tconsole.log(error);\n\t\t\t}else{\n\t\t\t\tconsole.log('SMS sent');\n\t\t\t\tMeteor.call('insertSMS',toUserId,smsBody,toNumber,function(error,result){\n\t\t\t\t\tif(error){\n\t\t\t\t\t\tconsole.log(error,'danger', 'growl-top-right');\n\t\t\t\t\t}else if(result){\n\t\t\t\t\t\tconsole.log(\"SMS sent\",'success', 'growl-top-right');\n\n\t\t\t\t\t}\n\t\t\t\t}); // end of insertSMS\n\t\t\t}\n\t\t})\n\n\t} // if inputObj\n\n}\n\ngetMailId = function(to,templateName){\n\tvar userData = Meteor.users.findOne({'_id':to});\n\tif(userData){\n\t\tvar emailAddress = userData.emails[0].address;\n\t}//userData\n\treturn emailAddress;\n}\n\ngetSubject = function(templateName){\n\tvar NotificationData = NotificationTemplate.findOne({'templateName':templateName});\n\tif(NotificationData){\n\t\tvar subject = NotificationData.subject;\n\t}//NotificationData\n\n\treturn subject;\n\n}\n\ngetMessageContent = function(templateName,varObj){\n\t// get all content from templatename\n\n\tvar NotificationData = NotificationTemplate.findOne({\"templateType\" : \"Email\",'templateName':templateName});\n\tif(NotificationData){\n\t\tvar content = NotificationData.content;\n\t\tcontent = content.replace(\"<p>\", \"<div>\");\n\t\tcontent = content.replace(\"</p>\", \"</div>\");\n\t\tcontent = content.replace(\"&nbsp;\", \" \");\n\t\tvar words = content.split(' ');\n\t\tvar tokens = [];\n\t\tvar n = 0;\n\t\tfor(i=0;i<words.length;i++){\n\t\t\tif(words[i].charAt(0)=='['){\n\t\t\t\ttokens[n] = words[i];\n\t\t\t\tif(tokens[n].substr(tokens[n].length - 1) != ']'){\n\t\t\t\t   tokens[n] = tokens[n].substr(0,tokens[n].length - 1) ;\n\t\t\t\t}\n\t\t\t\tn++;\n\t\t\t}\n\t\t}\n\n\n\t\tvar numOfVar = Object.keys(varObj).length;\n\t\tfor(i=0; i<numOfVar; i++){\n\t\t\tcontent = content.replace(tokens[i],varObj[tokens[i]]);\n\t\t}\n\t}//NotificationData\n\n\treturn content;\n}\n\ngetSMSContent = function(templateName,varObj){\n\t// get all content from templatename\n\n\tvar NotificationData = NotificationTemplate.findOne({\"templateType\" : \"SMS\",'templateName':templateName});\n\tif(NotificationData){\n\t\tvar content = NotificationData.content;\n\t\tcontent = content.replace(\"<p>\", \"<div>\");\n\t\tcontent = content.replace(\"</p>\", \"</div>\");\n\t\tcontent = content.replace(\"&nbsp;\", \" \");\n\t\tvar words = content.split(' ');\n\t\tvar tokens = [];\n\t\tvar n = 0;\n\t\tfor(i=0;i<words.length;i++){\n\t\t\tif(words[i].charAt(0)=='['){\n\t\t\t\ttokens[n] = words[i];\n\t\t\t\tif(tokens[n].substr(tokens[n].length - 1) != ']'){\n\t\t\t\t   tokens[n] = tokens[n].substr(0,tokens[n].length - 1) ;\n\t\t\t\t}\n\t\t\t\tn++;\n\t\t\t}\n\t\t}\n\n\n\t\tvar numOfVar = Object.keys(varObj).length;\n\t\tfor(i=0; i<numOfVar; i++){\n\t\t\tcontent = content.replace(tokens[i],varObj[tokens[i]]);\n\t\t}\n\t}//NotificationData\n\n\treturn content;\n}\n\ngetNotificationContent = function(templateName,varObj){\n\tvar NotificationData = NotificationTemplate.findOne({\"templateType\" : \"Notification\",'templateName':templateName});\n\tif(NotificationData){\n\t\tvar content = NotificationData.content;\n\t\tcontent = content.replace(\"<p>\", \"<div>\");\n\t\tcontent = content.replace(\"</p>\", \"</div>\");\n\t\tcontent = content.replace(\"&nbsp;\", \" \");\n\t\tvar words = content.split(' ');\n\t\tvar tokens = [];\n\t\tvar n = 0;\n\t\tfor(i=0;i<words.length;i++){\n\t\t\tif(words[i].charAt(0)=='['){\n\t\t\t\ttokens[n] = words[i];\n\t\t\t\tif(tokens[n].substr(tokens[n].length - 1) != ']'){\n\t\t\t\t   tokens[n] = tokens[n].substr(0,tokens[n].length - 1) ;\n\t\t\t\t}\n\t\t\t\tn++;\n\t\t\t}\n\t\t}\n\n\n\t\tvar numOfVar = Object.keys(varObj).length;\n\t\tfor(i=0; i<numOfVar; i++){\n\t\t\tcontent = content.replace(tokens[i],varObj[tokens[i]]);\n\t\t}\n\t}//NotificationData\n\n\treturn content;\n}\n\n"]},"hash":"26d78e25013bfb3788596cea17a68ccaaf570d15"}
